# é¡¹ç›®å®Œæˆæ€»ç»“

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- âœ… ç”¨æˆ·æ³¨å†Œ
- âœ… ç”¨æˆ·ç™»å½•/ç™»å‡º
- âœ… è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- âœ… ä¿®æ”¹å¯†ç 
- âœ… Session ç®¡ç†(MemoryStore)
- âœ… å¯†ç åŠ å¯†(bcrypt)
- âœ… è®¤è¯ä¸­é—´ä»¶

### 2. æœåŠ¡å™¨ç®¡ç†ç³»ç»Ÿ
- âœ… åˆ›å»º/æ›´æ–°/åˆ é™¤æœåŠ¡å™¨é…ç½®
- âœ… æŸ¥çœ‹æœåŠ¡å™¨åˆ—è¡¨
- âœ… æœåŠ¡å™¨åˆ†ç»„ç®¡ç†
- âœ… æ”¯æŒå¯†ç å’Œå¯†é’¥è®¤è¯
- âœ… æ ‡ç­¾ç³»ç»Ÿ
- âœ… æ“ä½œæ—¥å¿—è®°å½•
- âœ… æ“ä½œäººè¿½è¸ª

### 3. SSH è¿æ¥
- âœ… WebSocket SSH è¿æ¥
- âœ… å®æ—¶ç»ˆç«¯äº¤äº’
- âœ… çª—å£å¤§å°è°ƒæ•´
- âœ… è¿æ¥å†å²è®°å½•

## ğŸ“Š æ•°æ®åº“è¡¨

### users - ç”¨æˆ·è¡¨
- ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
- å¯†ç å“ˆå¸Œ
- ç™»å½•æ—¶é—´è¿½è¸ª

### remote_servers - è¿œç¨‹æœåŠ¡å™¨è¡¨
- æœåŠ¡å™¨è¿æ¥ä¿¡æ¯
- è®¤è¯é…ç½®
- æ ‡ç­¾å’Œæè¿°
- åˆ›å»ºäºº/æ›´æ–°äººè¿½è¸ª

### server_groups - æœåŠ¡å™¨åˆ†ç»„è¡¨
- åˆ†ç»„ç®¡ç†
- å¤šå¯¹å¤šå…³ç³»

### server_operation_logs - æ“ä½œæ—¥å¿—è¡¨
- å®Œæ•´çš„æ“ä½œå®¡è®¡
- ç”¨æˆ·è¡Œä¸ºè¿½è¸ª

### ssh_connections - SSH è¿æ¥å†å²è¡¨
- è¿æ¥è®°å½•
- æ—¶é—´è¿½è¸ª

## ğŸ”Œ API ç«¯ç‚¹

### è®¤è¯ç›¸å…³
- `POST /api/auth/register` - æ³¨å†Œ
- `POST /api/auth/login` - ç™»å½•
- `POST /api/auth/logout` - ç™»å‡º
- `GET /api/auth/me` - è·å–å½“å‰ç”¨æˆ·
- `POST /api/auth/change-password` - ä¿®æ”¹å¯†ç 

### æœåŠ¡å™¨ç®¡ç†
- `POST /api/servers` - åˆ›å»ºæœåŠ¡å™¨
- `GET /api/servers` - è·å–æœåŠ¡å™¨åˆ—è¡¨
- `GET /api/servers/{id}` - è·å–å•ä¸ªæœåŠ¡å™¨
- `PUT /api/servers/{id}` - æ›´æ–°æœåŠ¡å™¨
- `DELETE /api/servers/{id}` - åˆ é™¤æœåŠ¡å™¨

### åˆ†ç»„ç®¡ç†
- `POST /api/server-groups` - åˆ›å»ºåˆ†ç»„
- `GET /api/server-groups` - è·å–åˆ†ç»„åˆ—è¡¨

### SSH è¿æ¥
- `GET /ssh` - WebSocket SSH è¿æ¥

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### åç«¯æ¡†æ¶
- **Axum 0.8** - Web æ¡†æ¶
- **Tower** - ä¸­é—´ä»¶
- **SQLx** - æ•°æ®åº“è®¿é—®
- **SQLite** - æ•°æ®åº“

### è®¤è¯ä¸å®‰å…¨
- **tower-sessions** - Session ç®¡ç†
- **bcrypt** - å¯†ç åŠ å¯†
- **validator** - è¾“å…¥éªŒè¯

### SSH åŠŸèƒ½
- **russh** - SSH å®¢æˆ·ç«¯
- **WebSocket** - å®æ—¶é€šä¿¡

## ğŸ“ é¡¹ç›®ç»“æ„

```
sc/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs           # ä¸»å…¥å£,è·¯ç”±é…ç½®
â”‚   â”œâ”€â”€ logger/           # æ—¥å¿—æ¨¡å—
â”‚   â”œâ”€â”€ user/             # ç”¨æˆ·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ models.rs     # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ service.rs    # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ handlers.rs   # HTTP å¤„ç†å™¨
â”‚   â”‚   â””â”€â”€ middleware.rs # è®¤è¯ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ server/           # æœåŠ¡å™¨ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ models.rs
â”‚   â”‚   â”œâ”€â”€ service.rs
â”‚   â”‚   â””â”€â”€ handlers.rs
â”‚   â””â”€â”€ ssh/              # SSH æ¨¡å—
â”‚       â”œâ”€â”€ handler.rs
â”‚       â””â”€â”€ session.rs
â”œâ”€â”€ migrations/           # æ•°æ®åº“è¿ç§»
â”‚   â”œâ”€â”€ 20260116000001_create_users.sql
â”‚   â”œâ”€â”€ 20260116000002_create_ssh_connections.sql
â”‚   â”œâ”€â”€ 20260116000003_create_remote_servers.sql
â”‚   â””â”€â”€ 20260116000004_create_operation_logs.sql
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ USER_API.md          # ç”¨æˆ· API æ–‡æ¡£
â”œâ”€â”€ SERVER_API.md        # æœåŠ¡å™¨ API æ–‡æ¡£
â”œâ”€â”€ AUTH_MIDDLEWARE.md   # è®¤è¯ä¸­é—´ä»¶æ–‡æ¡£
â”œâ”€â”€ SESSION_GUIDE.md     # Session ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ WEBSOCKET_GUIDE.md   # WebSocket æŒ‡å—
â”œâ”€â”€ DATABASE_CONFIG.md   # æ•°æ®åº“é…ç½®è¯´æ˜
â””â”€â”€ MIGRATIONS.md        # è¿ç§»æ–‡æ¡£
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

1. **å¯†ç åŠ å¯†**: bcrypt å“ˆå¸Œ,cost=12
2. **Session ç®¡ç†**: å®‰å…¨çš„ session å­˜å‚¨
3. **è®¤è¯ä¸­é—´ä»¶**: ä¿æŠ¤æ•æ„Ÿè·¯ç”±
4. **ç”¨æˆ·éš”ç¦»**: æ•°æ®è®¿é—®æƒé™æ§åˆ¶
5. **æ“ä½œå®¡è®¡**: å®Œæ•´çš„æ“ä½œæ—¥å¿—
6. **æ•æ„Ÿä¿¡æ¯ä¿æŠ¤**: å¯†ç /å¯†é’¥ä¸åœ¨å“åº”ä¸­è¿”å›

## ğŸ¯ å…³é”®è®¾è®¡å†³ç­–

### AppState æ¨¡å¼
ä½¿ç”¨ç»Ÿä¸€çš„ `AppState` ç®¡ç†æ‰€æœ‰æœåŠ¡,è§£å†³ Axum å¤š State ç±»å‹å†²çª:

```rust
#[derive(Clone)]
pub struct AppState {
    pub user_service: UserService,
    pub server_service: ServerService,
}
```

### ä¸­é—´ä»¶è®¾è®¡
è®¤è¯ä¸­é—´ä»¶æ³¨å…¥ `CurrentUser` åˆ° request extensions:

```rust
pub struct CurrentUser {
    pub user_id: i64,
    pub username: String,
}
```

### æ“ä½œæ—¥å¿—
è‡ªåŠ¨è®°å½•æ‰€æœ‰æœåŠ¡å™¨ç®¡ç†æ“ä½œ,åŒ…å«:
- æ“ä½œäººä¿¡æ¯
- æ“ä½œç±»å‹
- æ“ä½œè¯¦æƒ…
- æ—¶é—´æˆ³

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### 1. å¯åŠ¨æœåŠ¡å™¨
```bash
cargo run
```

### 2. æ³¨å†Œç”¨æˆ·
```bash
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "password123",
    "email": "admin@example.com",
    "display_name": "ç®¡ç†å‘˜"
  }'
```

### 3. ç™»å½•
```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -c cookies.txt \
  -d '{
    "username": "admin",
    "password": "password123"
  }'
```

### 4. åˆ›å»ºæœåŠ¡å™¨
```bash
curl -X POST http://localhost:3000/api/servers \
  -H "Content-Type: application/json" \
  -b cookies.txt \
  -d '{
    "name": "ç”Ÿäº§æœåŠ¡å™¨",
    "host": "192.168.1.100",
    "port": 22,
    "username": "root",
    "auth_type": "password",
    "password": "server_password",
    "tags": ["production", "web"]
  }'
```

## ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

1. **å‰ç«¯å¼€å‘**: åˆ›å»º Web UI
2. **Redis Session**: ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ Redis å­˜å‚¨ session
3. **HTTPS**: é…ç½® SSL/TLS
4. **CSRF ä¿æŠ¤**: æ·»åŠ  CSRF token
5. **é€Ÿç‡é™åˆ¶**: é˜²æ­¢æš´åŠ›ç ´è§£
6. **æ—¥å¿—æŸ¥è¯¢**: æ·»åŠ æ“ä½œæ—¥å¿—æŸ¥è¯¢æ¥å£
7. **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡ç®¡ç†æœåŠ¡å™¨
8. **å¯¼å…¥å¯¼å‡º**: æœåŠ¡å™¨é…ç½®å¯¼å…¥å¯¼å‡º
9. **æƒé™ç³»ç»Ÿ**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
10. **ç›‘æ§å‘Šè­¦**: æœåŠ¡å™¨çŠ¶æ€ç›‘æ§

## ğŸ“š æ–‡æ¡£

æ‰€æœ‰æ–‡æ¡£å·²åˆ›å»ºå¹¶ä¿å­˜åœ¨é¡¹ç›®æ ¹ç›®å½•:
- `USER_API.md` - ç”¨æˆ·è®¤è¯ API
- `SERVER_API.md` - æœåŠ¡å™¨ç®¡ç† API  
- `AUTH_MIDDLEWARE.md` - è®¤è¯ä¸­é—´ä»¶
- `SESSION_GUIDE.md` - Session ä½¿ç”¨
- `WEBSOCKET_GUIDE.md` - WebSocket é›†æˆ
- `DATABASE_CONFIG.md` - æ•°æ®åº“é…ç½®
- `MIGRATIONS.md` - æ•°æ®åº“è¿ç§»

## âœ¨ é¡¹ç›®äº®ç‚¹

1. **å®Œæ•´çš„ç”¨æˆ·ç³»ç»Ÿ**: æ³¨å†Œã€ç™»å½•ã€æƒé™ç®¡ç†
2. **æ“ä½œå®¡è®¡**: å®Œæ•´çš„æ“ä½œæ—¥å¿—è¿½è¸ª
3. **ç±»å‹å®‰å…¨**: å……åˆ†åˆ©ç”¨ Rust ç±»å‹ç³»ç»Ÿ
4. **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„ä»£ç ç»„ç»‡
5. **è¯¦ç»†æ–‡æ¡£**: å®Œå–„çš„ API å’Œä½¿ç”¨æ–‡æ¡£
6. **å®‰å…¨ç¬¬ä¸€**: å¤šå±‚å®‰å…¨é˜²æŠ¤
7. **å®æ—¶é€šä¿¡**: WebSocket SSH è¿æ¥

é¡¹ç›®å·²ç»å…·å¤‡äº†ä¸€ä¸ªå®Œæ•´çš„ SSH æœåŠ¡å™¨ç®¡ç†ç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½!ğŸ‰
